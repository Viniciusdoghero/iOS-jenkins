#!groovy
@Library("NsPipelineLib") _
env.gitToken = "0641455876e8e575a63fc26a975424ae08c32297"

import groovy.json.JsonSlurperClassic
node {
  echo env.BUILD_NUMBER
  env.PATH = "/Users/dog-hero-ci/.rbenv/bin:/Users/dog-hero-ci/.fastlane/bin:/Users/dog-hero-ci/.rbenv/shims:/Users/dog-hero-ci/.rbenv/bin:/Users/dog-hero-ci/.fastlane/bin:/Users/dog-hero-ci/.rbenv/shims:/Users/dog-hero-ci/.rvm/gems/ruby-2.4.0/bin:/Users/ios_slave/.rvm/gems/ruby-2.4.0@global/bin:/Users/dog-hero-ci/.rvm/rubies/ruby-2.4.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Users/dog-hero-ci/.rvm/bin:/Users/dog-hero-ci/.rvm/bin"

  currentBuild.result = "SUCCESS"

    echo "+++branch: ${env.branch}"
    echo "+++upload: ${env.upload}"
    echo "+++commit: ${env.commit}"
    echo "+++lane: ${env.lane}"
    echo "+++ statusUrl: ${env.statusUrl}"
    echo "+++ commentUrl: ${env.commentUrl}"

    sh "source ~/.bash_profile"

    // if (env.lane == "appstore") {
    //   try {
    //     deployToAppStore()
    //   } catch (e){
    //     currentBuild.result = "FAILURE"
    //     return
    //   }
    // } else if (env.upload == "true") {
    //   try {
    //     buildStarted()
    //     deployBeta(env.branch)
    //   } catch (e) {
    //     currentBuild.result = "FAILURE"
    //     buildFinal()
    //     return
    //   }
    // } else {
    //   try {
    //     buildStarted()
    //     runUnitTests("", env.branch)
    //   } catch (e) {
    //     currentBuild.result = "FAILURE"
    //     buildFinal()
    //     return
    //   }
    // }
    //
    // buildFinal()
  }
